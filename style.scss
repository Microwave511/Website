/* Keep your original variables */
$color-env          : #0077B2;
$color-env2         : darken($color-env, 3%);
$color-flap         : darken($color-env, 20%);
$color-bg           : lighten($color-env, 48%);
$color-heart        : #D00000; 

$env-border-radius  : 6px;
$env-width          : 280px;
$env-height         : 180px;
$heart-width        : 50px;

body {
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column; /* Changed to allow button below */
    justify-content: center;
    align-items: center;
    background: $color-bg;
    font-family: Georgia, serif;
}

#envelope {
    position: relative;
    width: $env-width;
    height: $env-height;
    border-bottom-left-radius: $env-border-radius;
    border-bottom-right-radius: $env-border-radius;
    background-color: $color-flap;
    box-shadow: 0 4px 20px rgba(0,0,0,.2);
}

.front { 
    position: absolute;
    width: 0;
    height: 0;
    z-index: 3;
}

.flap {
    border-left: ($env-width / 2) solid transparent;
    border-right: ($env-width / 2) solid transparent;
    border-bottom: ($env-height / 2 - 8) solid transparent; 
    border-top: ($env-height / 2 + 8) solid $color-flap; 
    transform-origin: top;
    pointer-events: none;
    transition: transform .4s ease, z-index .6s;
    z-index: 5; /* Start on top */
}

.pocket {
    position: absolute;
    top: 0;
    border-left: ($env-width / 2) solid $color-env;
    border-right: ($env-width / 2) solid $color-env;
    border-bottom: ($env-height / 2) solid $color-env2;
    border-top: ($env-height / 2) solid transparent;
    border-bottom-left-radius: $env-border-radius;
    border-bottom-right-radius: $env-border-radius;
    z-index: 4;
}

.letter {
    position: relative;
    background-color: #fff;
    width: 90%;
    margin-left: auto;
    margin-right: auto;
    height: 90%;
    top: 5%;
    border-radius: $env-border-radius;
    box-shadow: 0 2px 26px rgba(0,0,0,.12);
    z-index: 1;
    transition: transform .4s ease;
}

/* Animations for Opening */
.open .flap {
    transform: rotateX(180deg);
    z-index: 1;
}

.open .letter {
    transform: translateY(-($env-height / 2));
    z-index: 2;
}

/* Heart Styles */
.hearts {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 2;
}

.heart {
    position: absolute;
    bottom: 0;
    opacity: 0;
}

.heart:before, .heart:after {
    position: absolute;
    content: "";
    left: $heart-width;
    top: 0;
    width: $heart-width;
    height: ($heart-width * 1.6);
    background: $color-heart;
    border-radius: $heart-width $heart-width 0 0;
    transform: rotate(-45deg);
    transform-origin: 0 100%;
}

.heart:after {
    left: 0;
    transform: rotate(45deg);
    transform-origin: 100% 100%;
}

/* Fixed Animation Syntax */
.open .a1 {
    left: 20%;
    transform: scale(0.6);
    opacity: 1;
    animation: slideUp 4s linear forwards, sideSway 2s ease-in-out infinite alternate;
    animation-delay: 0.7s;
}

.open .a2 {
    left: 55%;
    transform: scale(1);
    opacity: 1;
    animation: slideUp 5s linear forwards, sideSway 4s ease-in-out infinite alternate;
    animation-delay: 1s;
}

.open .a3 {
    left: 10%;
    transform: scale(0.8);
    opacity: 1;
    animation: slideUp 7s linear forwards, sideSway 2s ease-in-out infinite alternate;
    animation-delay: 1.2s;
}

@keyframes slideUp { 
    0% { top: 0; opacity: 1; }
    100% { top: -600px; opacity: 0; }
}

@keyframes sideSway {
    0% { margin-left: 0px; }
    100% { margin-left: 50px; }
}

/* Reset Button */
.reset button {
    margin-top: 200px;
    background: white;
    border: 2px solid $color-env;
    color: $color-env;
    padding: 10px 20px;
    cursor: pointer;
    font-weight: bold;
    &:hover {
        background: $color-env;
        color: white;
    }
}
